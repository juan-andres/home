<audio id="player" preload="auto"></audio>

<div id="playlist_content"></div>

<script>
  function reqListener () {
    var playlistDom = document.getElementById('playlist_content');
    var player = document.getElementById('player');
    var playlists = JSON.parse(this.responseText);
    
    function onclick(track, e) {
      player.src =  track.preview_url;
      player.play();
    }

    for (var i = 0; i < playlists.tracks.items.length; i++) {
      var img = new Image(500, 500);

      var track = playlists.tracks.items[i].track;
      img.addEventListener('click', onclick.bind(null, track));
      img.src = track.album.images[0].url;
      playlistDom.appendChild(img);
    }
  }
  

  var oReq = new XMLHttpRequest();
  oReq.addEventListener("load", reqListener);
  oReq.open("GET", "https://juanandres-spotify-micro.herokuapp.com/playlistOfTheMonth", true);
  oReq.send();
</script>
